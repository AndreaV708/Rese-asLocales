<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Detalle de Local - UTAvisor</title> <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta content="Detalle local UTA, reseña local Ambato, [Nombre Local Específico]" name="keywords"> <meta content="Información detallada, reseñas y fotos del local [Nombre Local Específico] cerca de la Universidad Técnica de Ambato." name="description"> <link href="img/favicon.ico" rel="icon"> <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">

    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet"> <link href="lib/owlcarousel/assets/owl.carousel.min.css" rel="stylesheet">
    <link href="lib/tempusdominus/css/tempusdominus-bootstrap-4.min.css" rel="stylesheet" />

    <link href="css/style.css" rel="stylesheet">
     <style>
         /* Estilos para estrellas y reviews que tenías */
        .fa-star {
            cursor: pointer;
        }
        .fa-star.text-warning {
            color: #ffc107 !important;
        }
        .fa-star.text-muted {
            color: #e4e5e9 !important;
        }
        .review-item {
            border-bottom: 1px solid #eee;
            padding-bottom: 1rem;
            margin-bottom: 1rem;
        }
         .review-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
        }
        #imagePreview img { /* Estilo para previsualización de imágenes */
            max-width: 100px;
            max-height: 100px;
            object-fit: cover;
            margin-right: 0.5rem;
            margin-bottom: 0.5rem;
            border: 1px solid #ddd;
            border-radius: .25rem;
        }
    </style>
</head>

<body>
    <div class="container-fluid bg-light pt-3 d-none d-lg-block">
        <div class="container">
            <div class="row">
                 <div class="col-lg-6 text-center text-lg-left mb-2 mb-lg-0">
                    <div class="d-inline-flex align-items-center">
                        <a href="contact.html" class="text-dark px-2">
                             💬 ¿Tienes una recomendación? <strong>¡Escríbenos!</strong>
                        </a>
                    </div>
                </div>
                <div class="col-lg-6 text-center text-lg-right">
                    <div class="d-inline-flex align-items-center">
                         <a class="text-primary px-3" href="#"><i class="fab fa-facebook-f"></i></a>
                        <a class="text-primary px-3" href="#"><i class="fab fa-twitter"></i></a>
                        <a class="text-primary px-3" href="#"><i class="fab fa-linkedin-in"></i></a>
                        <a class="text-primary px-3" href="#"><i class="fab fa-instagram"></i></a>
                        <a class="text-primary pl-3" href="#"><i class="fab fa-youtube"></i></a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="container-fluid position-relative nav-bar p-0">
        <div class="container-lg position-relative p-0 px-lg-3" style="z-index: 9;">
            <nav class="navbar navbar-expand-lg bg-light navbar-light shadow-lg py-3 py-lg-0 pl-3 pl-lg-5">
                 <a href="index.html" class="navbar-brand"> <h1 class="m-0 text-primary"><span class="text-dark">UTA</span>visor</h1>
                </a>
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbarCollapse">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse justify-content-between px-3" id="navbarCollapse">
                    <div class="navbar-nav ml-auto py-0">
                        <a href="index.html" class="nav-item nav-link">Bienvenidos</a>
                        <a href="about.html" class="nav-item nav-link">Sobre</a>
                        <a href="package.html" class="nav-item nav-link">Lugares</a>
                        <div class="nav-item dropdown">
                             <a href="#" class="nav-link dropdown-toggle active" data-toggle="dropdown">Páginas</a>
                            <div class="dropdown-menu border-0 rounded-0 m-0">
                                <a href="blog.html" class="dropdown-item">Blog</a>
                                 <a href="single.html" class="dropdown-item active">Detalle Local</a>
                                <a href="destination.html" class="dropdown-item">Destinos/Categorías</a>
                                <a href="guide.html" class="dropdown-item">Guías/Equipo</a>
                                <a href="testimonial.html" class="dropdown-item">Testimonios</a>
                            </div>
                        </div>
                        <a href="contact.html" class="nav-item nav-link">Contacto</a>
                    </div>
                </div>
            </nav>
        </div>
    </div>
    <div class="container-fluid page-header">
        <div class="container">
            <div class="d-flex flex-column align-items-center justify-content-center" style="min-height: 400px">
                <h3 class="display-4 text-white text-uppercase">Detalle del Local</h3>
                <div class="d-inline-flex text-white">
                     <p class="m-0 text-uppercase"><a class="text-white" href="index.html">Inicio</a></p>
                    <i class="fa fa-angle-double-right pt-1 px-3"></i>
                     <p class="m-0 text-uppercase"><a class="text-white" href="blog.html">Blog</a></p> <i class="fa fa-angle-double-right pt-1 px-3"></i>
                    <p class="m-0 text-uppercase">Detalle</p>
                </div>
            </div>
        </div>
    </div>
    <div class="container-fluid py-5">
        <div class="container py-5">
            <div class="row">
                <div class="col-lg-8">
                    <div class="pb-3">
                        <div class="blog-item">
                            <div class="position-relative">
                                <img class="img-fluid w-100 rounded shadow-sm" src="img/Chamiko Food and Friends principal.jpg" alt="[Nombre del Local]">
                                <div class="blog-date">
                                    <i class="fa fa-utensils fa-2x text-white"></i>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white mb-3 shadow-sm rounded" style="padding: 30px;">
                            <div class="d-flex mb-3">
                                <a class="text-primary text-uppercase text-decoration-none" href="#">Comida</a> <span class="text-primary px-2">|</span>
                                <a class="text-primary text-uppercase text-decoration-none" href="#">Cerca Campus Huachi</a> </div>
                            <h1 class="mb-3">[Nombre del Local - Ej: Chamiko Food and Friends]</h1>
                            <p>Aquí va la descripción detallada del local. Puedes hablar sobre el tipo de comida, el ambiente, los precios aproximados, si es bueno para grupos, si tiene WiFi, horarios, etc. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.</p>
                            <p>Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur.</p>

                            <h4 class="mb-3 mt-4">Galería</h4>
                            <div class="row">
                                <div class="col-4 mb-3">
                                     <img class="img-fluid rounded" src="img/local_detalle_1.jpg" alt="Detalle 1">
                                </div>
                                <div class="col-4 mb-3">
                                     <img class="img-fluid rounded" src="img/local_detalle_2.jpg" alt="Detalle 2">
                                </div>
                                <div class="col-4 mb-3">
                                     <img class="img-fluid rounded" src="img/local_detalle_3.jpg" alt="Detalle 3">
                                </div>
                            </div>

                             <h4 class="mb-3 mt-4">Ubicación</h4>
                             <div class="embed-responsive embed-responsive-16by9">
                                <iframe class="embed-responsive-item" src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3988.817391672894!2d-78.6292!3d-1.2800!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x0%3A0x0!2zMTPCsDE2JzQ4LjAiUyA3OMKwMzcnNDUuMSJX!5e0!3m2!1ses!2sec!4v1620000000000!5m2!1ses!2sec" width="600" height="450" style="border:0;" allowfullscreen="" loading="lazy"></iframe>
                             </div>

                        </div>
                    </div>
                    <div class="bg-white mb-5 p-4 shadow-sm rounded">
                        <h4 class="text-uppercase mb-4" style="letter-spacing: 5px;">Reseñas de Estudiantes (<span id="reviewCount">0</span>)</h4>
                         <div id="reviewsListContainer">
                            <div class="review-item mb-4">
                                <div class="d-flex align-items-center mb-2">
                                    <img src="img/user.jpg" alt="Usuario" class="rounded-circle" style="width: 50px; height: 50px;">
                                    <div class="ml-3">
                                        <h6 class="mb-0">Nombre Estudiante</h6>
                                        <small class="text-muted">Hace 2 semanas</small>
                                    </div>
                                </div>
                                <div class="d-flex align-items-center mb-2">
                                    <div class="text-warning">
                                        <i class="fa fa-star"></i><i class="fa fa-star"></i><i class="fa fa-star"></i><i class="fa fa-star"></i><i class="fa fa-star-half-alt"></i>
                                    </div>
                                    <small class="ml-2 text-muted">4.5/5</small>
                                </div>
                                <p>¡Excelente lugar para almorzar! Buena porción y precio justo para estudiantes. Recomendado.</p>
                                </div>
                             <div class="review-item mb-4">
                                </div>
                         </div>
                    </div>
                    <div class="bg-white mb-3 p-4 shadow-sm rounded">
                        <h4 class="text-uppercase mb-4" style="letter-spacing: 5px;">Deja tu Reseña para [Nombre Local]</h4> <form id="reviewForm"> <div class="form-group">
                                 <label for="name">Nombre <span class="text-danger">*</span></label>
                                 <input type="text" class="form-control" id="name" required>
                                 <small class="text-danger d-none" id="nameError">El nombre es obligatorio.</small>
                             </div>
                             <div class="form-group">
                                 <label for="email">Correo (No se publicará) <span class="text-danger">*</span></label>
                                 <input type="email" class="form-control" id="email" required>
                                 <small class="text-danger d-none" id="emailError">Correo inválido u obligatorio.</small>
                             </div>
                            <div class="form-group">
                                <label for="rating">Calificación <span class="text-danger">*</span></label>
                                <div id="starRating" class="d-flex align-items-center">
                                    <i class="fa fa-star text-muted" data-value="1"></i>
                                    <i class="fa fa-star text-muted" data-value="2"></i>
                                    <i class="fa fa-star text-muted" data-value="3"></i>
                                    <i class="fa fa-star text-muted" data-value="4"></i>
                                    <i class="fa fa-star text-muted" data-value="5"></i>
                                </div>
                                <input type="hidden" id="rating" value="" required> <small class="text-danger d-none" id="ratingError">Por favor selecciona una calificación.</small>
                            </div>
                            <div class="form-group">
                                 <label for="title">Título de tu reseña <span class="text-danger">*</span></label>
                                 <input type="text" class="form-control" id="title" required>
                                 <small class="text-danger d-none" id="titleError">El título es obligatorio.</small>
                            </div>
                            <div class="form-group">
                                <label for="message">Tu Reseña <span class="text-danger">*</span></label>
                                <textarea id="message" cols="30" rows="5" class="form-control" required></textarea>
                                <small class="text-danger d-none" id="messageError">La reseña es obligatoria.</small>
                            </div>
                            <div class="form-group">
                                 <label for="images">Subir Imágenes (Opcional)</label>
                                 <input type="file" class="form-control-file" id="images" multiple accept="image/*">
                                 <div id="imagePreview" class="d-flex flex-wrap mt-2"></div> </div>
                            <div class="form-group mb-0">
                                <button type="submit" class="btn btn-primary font-weight-semi-bold py-2 px-3">Enviar Reseña</button>
                            </div>
                        </form>
                         <div id="reviewSubmitStatus" class="mt-3"></div> </div>
                    </div>

                <div class="col-lg-4 mt-5 mt-lg-0">
                    <div class="d-flex flex-column text-center bg-white mb-5 py-5 px-4 shadow-sm rounded">
                         <img src="img/user.jpg" class="img-fluid mx-auto mb-3 rounded-circle" style="width: 100px;"> <h3 class="text-primary mb-3">[Nombre Autor Post/Admin]</h3> <p>Breve descripción del autor o de UTAvisor. Promoviendo la información útil para estudiantes.</p>
                         <div class="d-flex justify-content-center">
                            <a class="text-primary px-2" href="#"><i class="fab fa-facebook-f"></i></a>
                            <a class="text-primary px-2" href="#"><i class="fab fa-twitter"></i></a>
                            <a class="text-primary px-2" href="#"><i class="fab fa-instagram"></i></a>
                         </div>
                    </div>

                    <div class="mb-5">
                         <div class="bg-white shadow-sm rounded p-4">
                            <div class="input-group">
                                <input type="text" class="form-control p-4" placeholder="Buscar en el blog...">
                                <div class="input-group-append">
                                    <span class="input-group-text bg-primary border-primary text-white"><i class="fa fa-search"></i></span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="mb-5">
                        <h4 class="text-uppercase mb-4" style="letter-spacing: 5px;">Categorías</h4>
                        <div class="bg-white shadow-sm rounded p-4">
                             <ul class="list-inline m-0">
                                <li class="mb-1 py-2 px-3 bg-light d-flex justify-content-between align-items-center rounded">
                                    <a class="text-dark" href="package.html#comida"><i class="fa fa-angle-right text-primary mr-2"></i>Comida</a>
                                    <span class="badge badge-primary badge-pill">15</span>
                                </li>
                                 <li class="mb-1 py-2 px-3 bg-light d-flex justify-content-between align-items-center rounded">
                                    <a class="text-dark" href="package.html#servicios"><i class="fa fa-angle-right text-primary mr-2"></i>Servicios</a>
                                    <span class="badge badge-primary badge-pill">10</span>
                                </li>
                                  <li class="mb-1 py-2 px-3 bg-light d-flex justify-content-between align-items-center rounded">
                                    <a class="text-dark" href="package.html#estudio"><i class="fa fa-angle-right text-primary mr-2"></i>Estudio</a>
                                    <span class="badge badge-primary badge-pill">8</span>
                                </li>
                                </ul>
                        </div>
                    </div>

                    <div class="mb-5">
                        <h4 class="text-uppercase mb-4" style="letter-spacing: 5px;">Últimas Reseñas</h4>
                         <div class="bg-white shadow-sm rounded p-4">
                            <a href="single.html#otro_local_1" class="d-flex align-items-center text-decoration-none bg-light mb-3 p-2 rounded">
                                <img class="img-fluid rounded" src="img/local_thumb_1.jpg" style="width: 80px; height: 80px; object-fit: cover;" alt="">
                                <div class="pl-3">
                                    <h6 class="m-1">Excelente café en [Otro Local]</h6>
                                    <small>Hace 1 día</small>
                                </div>
                            </a>
                             <a href="single.html#otro_local_2" class="d-flex align-items-center text-decoration-none bg-light mb-3 p-2 rounded">
                                 <img class="img-fluid rounded" src="img/local_thumb_2.jpg" style="width: 80px; height: 80px; object-fit: cover;" alt="">
                                <div class="pl-3">
                                    <h6 class="m-1">Copias rápidas y baratas en [Copiadora X]</h6>
                                    <small>Hace 3 días</small>
                                </div>
                            </a>
                             </div>
                    </div>

                    <div class="mb-5">
                        <h4 class="text-uppercase mb-4" style="letter-spacing: 5px;">Etiquetas</h4>
                        <div class="d-flex flex-wrap m-n1">
                             <a href="" class="btn btn-light m-1">Barato</a>
                            <a href="" class="btn btn-light m-1">WiFi</a>
                            <a href="" class="btn btn-light m-1">Tranquilo</a>
                            <a href="" class="btn btn-light m-1">Grupos</a>
                            <a href="" class="btn btn-light m-1">Rápido</a>
                            <a href="" class="btn btn-light m-1">Vegetariano</a>
                            <a href="" class="btn btn-light m-1">Huachi</a>
                            <a href="" class="btn btn-light m-1">Ingahuacho</a>
                        </div>
                    </div>
                </div>
                </div>
        </div>
    </div>
    <div id="footer-placeholder">
        </div>
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.bundle.min.js"></script>
    <script src="lib/easing/easing.min.js"></script>
    <script src="lib/owlcarousel/owl.carousel.min.js"></script>
    <script src="lib/tempusdominus/js/moment.min.js"></script>
    <script src="lib/tempusdominus/js/moment-timezone.min.js"></script>
    <script src="lib/tempusdominus/js/tempusdominus-bootstrap-4.min.js"></script>

    <script src="js/main.js"></script>

     <script>
        document.addEventListener("DOMContentLoaded", function() {
            const stars = document.querySelectorAll('#starRating .fa-star');
            const ratingInput = document.getElementById('rating');
            const imageInput = document.getElementById('images');
            const imagePreview = document.getElementById('imagePreview');
            const reviewForm = document.getElementById('reviewForm'); // Cambiado de commentForm

             // --- Lógica de Estrellas ---
             function highlightStars(value) {
                 const ratingValue = parseInt(value, 10) || 0;
                 stars.forEach(star => {
                     const starValue = parseInt(star.getAttribute('data-value'), 10);
                     if (starValue <= ratingValue) {
                         star.classList.add('text-warning');
                         star.classList.remove('text-muted');
                     } else {
                         star.classList.add('text-muted');
                         star.classList.remove('text-warning');
                     }
                 });
             }

             stars.forEach(star => {
                 star.addEventListener('mouseover', function () { highlightStars(this.getAttribute('data-value')); });
                 star.addEventListener('mouseout', function () { highlightStars(ratingInput.value); });
                 star.addEventListener('click', function () {
                     ratingInput.value = this.getAttribute('data-value');
                     highlightStars(ratingInput.value);
                      // Ocultar error de rating al hacer clic
                     const ratingError = document.getElementById('ratingError');
                     if(ratingError) ratingError.classList.add('d-none');
                 });
             });

            // --- Lógica de Previsualización de Imágenes ---
            if (imageInput && imagePreview) {
                imageInput.addEventListener('change', function () {
                    imagePreview.innerHTML = ''; // Limpiar previsualización anterior
                    if (this.files) {
                         Array.from(this.files).forEach(file => {
                             if (file.type.startsWith('image/')){ // Validar que sea imagen
                                 const reader = new FileReader();
                                 reader.onload = function (e) {
                                     const img = document.createElement('img');
                                     img.src = e.target.result;
                                     // Aplicar estilos directamente aquí o con CSS
                                     img.style.maxWidth = '100px';
                                     img.style.maxHeight = '100px';
                                     img.style.margin = '5px';
                                     img.style.objectFit = 'cover';
                                     img.style.border = '1px solid #ddd';
                                     img.style.borderRadius = '.25rem';
                                     imagePreview.appendChild(img);
                                 }
                                 reader.readAsDataURL(file);
                             }
                         });
                    }
                });
            }

            // --- Lógica de Validación y Envío del Formulario ---
             if(reviewForm) {
                 reviewForm.addEventListener('submit', function (e) {
                     e.preventDefault();
                     console.log("Form submission attempt..."); // Debug

                     // Ocultar errores previos
                     document.querySelectorAll('#reviewForm .text-danger').forEach(el => el.classList.add('d-none'));
                     const statusDiv = document.getElementById('reviewSubmitStatus');
                     if(statusDiv) statusDiv.innerHTML = ''; // Limpiar status

                     let isValid = true;

                      // Campos a validar
                      const fieldsToValidate = [
                          { id: 'name', errorId: 'nameError', msg: 'El nombre es obligatorio.' },
                          { id: 'email', errorId: 'emailError', msg: 'Correo inválido u obligatorio.', isEmail: true },
                          { id: 'rating', errorId: 'ratingError', msg: 'Por favor selecciona una calificación.', isRating: true },
                          { id: 'title', errorId: 'titleError', msg: 'El título es obligatorio.' },
                          { id: 'message', errorId: 'messageError', msg: 'La reseña es obligatoria.' }
                      ];

                     fieldsToValidate.forEach(field => {
                         const inputElement = document.getElementById(field.id);
                         const errorElement = document.getElementById(field.errorId);
                         let value = inputElement ? inputElement.value.trim() : '';
                         let fieldIsValid = true;

                         if (!value || (field.isRating && (value < 1 || value > 5)) || (field.isEmail && !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(value)) ) {
                            fieldIsValid = false;
                         }

                         if (!fieldIsValid) {
                            console.log(`Validation failed for ${field.id}`); // Debug
                            if (errorElement) {
                                 errorElement.textContent = field.msg; // Opcional: Actualizar mensaje si es dinámico
                                 errorElement.classList.remove('d-none');
                            }
                            isValid = false;
                         }
                     });


                     if (isValid) {
                         console.log("Form is valid. Submitting..."); // Debug
                         // Aquí iría tu lógica para enviar los datos (AJAX/Fetch)
                         // Por ahora, solo mostramos un mensaje
                         if(statusDiv) statusDiv.innerHTML = '<div class="alert alert-success">¡Reseña enviada con éxito! (Simulación)</div>';
                         reviewForm.reset();
                         if(imagePreview) imagePreview.innerHTML = ''; // Limpiar preview
                         highlightStars(0); // Resetear estrellas visuales
                     } else {
                          console.log("Form is invalid."); // Debug
                          if(statusDiv) statusDiv.innerHTML = '<div class="alert alert-danger">Por favor corrige los errores marcados.</div>';
                     }
                 });
             } else {
                  console.error("Review form not found!");
             }


            // --- Cargar Footer ---
            fetch('footer.html')
                .then(response => {
                    if (!response.ok) { throw new Error('Network response was not ok ' + response.statusText); }
                    return response.text();
                })
                .then(html => {
                    const footerPlaceholder = document.getElementById('footer-placeholder');
                    if(footerPlaceholder) { footerPlaceholder.innerHTML = html; }
                    else { console.error("Footer placeholder not found!"); }
                })
                .catch(error => {
                    console.error('Error loading footer:', error);
                    const footerPlaceholder = document.getElementById('footer-placeholder');
                    if(footerPlaceholder) { footerPlaceholder.innerHTML = '<p class="text-center text-danger">Error al cargar el pie de página.</p>';}
                });

        }); // Fin DOMContentLoaded
    </script>

</body>
</html>