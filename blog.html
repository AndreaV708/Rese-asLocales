<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Blog - UTAvisor</title> <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta content="Blog UTAvisor, reseñas locales UTA, experiencias estudiantes Ambato" name="keywords"> <meta content="Lee las últimas reseñas y experiencias de estudiantes sobre locales y servicios cerca de la Universidad Técnica de Ambato." name="description"> <link href="img/favicon.ico" rel="icon"> <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">

    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css" rel="stylesheet">

    <link href="lib/owlcarousel/assets/owl.carousel.min.css" rel="stylesheet">
    <link href="lib/tempusdominus/css/tempusdominus-bootstrap-4.min.css" rel="stylesheet" />

    <link href="css/style.css" rel="stylesheet">
    <style>
        /* Estilos para las estrellas y reviews (ya estaban en tu código) */
        .fa-star {
            cursor: pointer;
            font-size: 1.5rem; /* Tamaño ajustado */
        }
        .fa-star.text-warning { /* Usar warning para amarillo de Bootstrap */
             color: #ffc107 !important;
        }
        .fa-star.text-muted {
             color: #e4e5e9 !important; /* Color grisáceo */
        }
        .review-item {
            border-bottom: 1px solid #eee; /* Borde más suave */
            padding-bottom: 1rem;
            margin-bottom: 1rem;
        }
        .review-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
        }
         /* Estilo para resaltar formulario al hacer clic en enlace */
        #reviewForm.border-primary {
            border-color: #007bff !important; /* Asegura que el color sea visible */
            transition: border-color 0.3s ease-in-out;
        }
    </style>
</head>

<body>
    <div class="container-fluid bg-light pt-3 d-none d-lg-block">
        <div class="container">
            <div class="row">
                <div class="col-lg-6 text-center text-lg-left mb-2 mb-lg-0">
                    <div class="d-inline-flex align-items-center">
                        <a href="contact.html" class="text-dark px-2">
                             💬 ¿Tienes una recomendación? <strong>¡Escríbenos!</strong>
                        </a>
                    </div>
                </div>
                 <div class="col-lg-6 text-center text-lg-right">
                     <div class="d-inline-flex align-items-center">
                         <a class="text-primary px-3" href="#"><i class="fab fa-facebook-f"></i></a>
                        <a class="text-primary px-3" href="#"><i class="fab fa-twitter"></i></a>
                        <a class="text-primary px-3" href="#"><i class="fab fa-linkedin-in"></i></a>
                        <a class="text-primary px-3" href="#"><i class="fab fa-instagram"></i></a>
                        <a class="text-primary pl-3" href="#"><i class="fab fa-youtube"></i></a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="container-fluid position-relative nav-bar p-0">
        <div class="container-lg position-relative p-0 px-lg-3" style="z-index: 9;">
            <nav class="navbar navbar-expand-lg bg-light navbar-light shadow-lg py-3 py-lg-0 pl-3 pl-lg-5">
                <a href="index.html" class="navbar-brand"> <h1 class="m-0 text-primary"><span class="text-dark">UTA</span>visor</h1>
                </a>
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbarCollapse">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse justify-content-between px-3" id="navbarCollapse">
                    <div class="navbar-nav ml-auto py-0">
                        <a href="index.html" class="nav-item nav-link">Bienvenidos</a>
                        <a href="about.html" class="nav-item nav-link">Sobre</a>
                        <a href="package.html" class="nav-item nav-link">Lugares</a>
                        <div class="nav-item dropdown">
                            <a href="#" class="nav-link dropdown-toggle active" data-toggle="dropdown">Páginas</a>
                            <div class="dropdown-menu border-0 rounded-0 m-0">
                                <a href="blog.html" class="dropdown-item active">Blog</a>
                                <a href="single.html" class="dropdown-item">Detalle Blog</a>
                                <a href="destination.html" class="dropdown-item">Destinos</a>
                                <a href="guide.html" class="dropdown-item">Guías</a>
                                <a href="testimonial.html" class="dropdown-item">Testimonios</a>
                            </div>
                        </div>
                        <a href="contact.html" class="nav-item nav-link">Contacto</a>
                    </div>
                </div>
            </nav>
        </div>
    </div>
    <div class="container-fluid page-header">
        <div class="container">
            <div class="d-flex flex-column align-items-center justify-content-center" style="min-height: 400px">
                <h3 class="display-4 text-white text-uppercase">Blog / Reseñas</h3> <div class="d-inline-flex text-white">
                    <p class="m-0 text-uppercase"><a class="text-white" href="index.html">Inicio</a></p> <i class="fa fa-angle-double-right pt-1 px-3"></i>
                    <p class="m-0 text-uppercase">Blog</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Header End -->


    <!-- Blog Start -->
<!-- Blog Start -->
<div class="container-fluid py-5">
    <div class="container py-5">
        <div class="row">
            <div class="col-lg-8">
                <div class="row pb-3">

                    <!-- Blog Items del 1 al 8 -->
                    <!-- Repite la misma estructura con diferentes lugares -->

                    <!-- 1 -->
                    <div class="col-md-6 mb-4 pb-2">
                        <div class="blog-item">
                            <div class="position-relative">
                                <a href="#reviewsContainer" class="review-link" data-local="Place 1">
                                    <img class="img-fluid w-100" src="img/blog-1.jpg" alt="Place 1">
                                </a>
                                <div class="blog-date">
                                    <h6 class="font-weight-bold mb-n1">01</h6>
                                    <small class="text-white text-uppercase">Jan</small>
                                </div>
                            </div>
                            <div class="bg-white p-4">
                                <div class="d-flex mb-2">
                                    <a class="text-primary text-uppercase text-decoration-none" href="">Admin</a>
                                    <span class="text-primary px-2">|</span>
                                    <a class="text-primary text-uppercase text-decoration-none" href="">Tours</a>
                                </div>
                                <a class="h5 m-0 text-decoration-none review-link" href="#reviewsContainer" data-local="Place 1">Discover the hidden gems of Place 1</a>

                            </div>
                        </div>

                        <div class="col-md-6 mb-4 pb-2">
                             <div class="blog-item shadow-sm">
                                <div class="position-relative">
                                     <a href="#reviewsContainer" class="review-link" data-local="La Monita Verde">
                                        <img class="img-fluid w-100" src="img/la monita Verde P.jpg" alt="La Monita Verde">
                                    </a>
                                    <div class="blog-date">
                                         <h6 class="font-weight-bold mb-n1">12</h6> <small class="text-white text-uppercase">Abr</small>
                                    </div>
                                </div>
                                <div class="bg-white p-4">
                                    <div class="d-flex mb-2">
                                        <a class="text-primary text-uppercase text-decoration-none" href="#">Batidos</a>
                                        <span class="text-primary px-2">|</span>
                                        <a class="text-primary text-uppercase text-decoration-none" href="#">Desayunos</a>
                                    </div>
                                     <a class="h5 m-0 text-decoration-none review-link" href="#reviewsContainer" data-local="La Monita Verde">La Monita Verde: Ideal para empezar el día</a>
                                </div>
                            </div>
                        </div>

                        </div>

                    <div id="reviewsContainer" class="container mt-5 pt-5"> <h2 class="text-center mb-4">Añade o Lee Reseñas</h2>
                         <form id="reviewForm" class="bg-light p-4 shadow mb-5 rounded">
                             <h4 id="reviewFormTitle" class="text-center text-primary mb-4">Selecciona un local para reseñar</h4>
                             <input type="hidden" id="localName" value="">

                             <div class="form-group">
                                 <label for="rating">Tu Calificación:</label>
                                 <div id="starRating" class="d-flex align-items-center">
                                     <i class="fa fa-star text-muted" data-value="1"></i>
                                     <i class="fa fa-star text-muted" data-value="2"></i>
                                     <i class="fa fa-star text-muted" data-value="3"></i>
                                     <i class="fa fa-star text-muted" data-value="4"></i>
                                     <i class="fa fa-star text-muted" data-value="5"></i>
                                 </div>
                                 <input type="hidden" id="rating" name="rating" value="">
                                 <small class="text-danger d-none" id="ratingError">Por favor selecciona una calificación.</small>
                             </div>

                             <div class="form-group">
                                 <label for="reviewText">Tu Reseña:</label>
                                 <textarea id="reviewText" name="reviewText" cols="30" rows="4" class="form-control" placeholder="Escribe tu opinión sobre este local..."></textarea>
                                 <small class="text-danger d-none" id="reviewTextError">El texto de la reseña es obligatorio.</small>
                             </div>

                             <div class="form-group mb-0 text-center">
                                 <button type="submit" class="btn btn-primary font-weight-semi-bold py-2 px-4">Enviar Reseña</button>
                             </div>
                         </form>

                         <div id="reviewsListContainer" class="mt-5">
                             <h3 class="text-center mb-4">Reseñas Recientes</h3>
                             <div id="reviewsList" class="bg-white p-4 shadow rounded">
                                 <p class="text-center text-muted">Selecciona un local para ver sus reseñas.</p>
                             </div>
                             </div>
                     </div> </div> <div class="col-lg-4 mt-5 mt-lg-0">
                    <div class="d-flex flex-column text-center bg-white mb-5 py-5 px-4 shadow-sm rounded">
                        <img src="img/user.jpg" class="img-fluid mx-auto mb-3" style="width: 100px;">
                        <h3 class="text-primary mb-3">Equipo UTAvisor</h3>
                        <p>Compartiendo las mejores experiencias y locales cerca de la UTA. ¡Únete a nuestra comunidad!</p>
                        <div class="d-flex justify-content-center">
                             <a class="text-primary px-2" href="#"><i class="fab fa-facebook-f"></i></a>
                             <a class="text-primary px-2" href="#"><i class="fab fa-twitter"></i></a>
                             <a class="text-primary px-2" href="#"><i class="fab fa-linkedin-in"></i></a>
                             <a class="text-primary px-2" href="#"><i class="fab fa-instagram"></i></a>
                        </div>
                    </div>

                    <div class="mb-5">
                        <div class="bg-white shadow-sm rounded p-4">
                            <div class="input-group">
                                <input type="text" class="form-control p-4" placeholder="Buscar local...">
                                <div class="input-group-append">
                                    <span class="input-group-text bg-primary border-primary text-white"><i class="fa fa-search"></i></span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="mb-5">
                        <h4 class="text-uppercase mb-4" style="letter-spacing: 5px;">Categorías</h4>
                        <div class="bg-white shadow-sm rounded p-4">
                            <ul class="list-inline m-0">
                                <li class="mb-1 py-2 px-3 bg-light d-flex justify-content-between align-items-center rounded">
                                    <a class="text-dark" href="#"><i class="fa fa-angle-right text-primary mr-2"></i>Restaurantes</a>
                                    <span class="badge badge-primary badge-pill">15</span> </li>
                                 <li class="mb-1 py-2 px-3 bg-light d-flex justify-content-between align-items-center rounded">
                                    <a class="text-dark" href="#"><i class="fa fa-angle-right text-primary mr-2"></i>Cafeterías</a>
                                    <span class="badge badge-primary badge-pill">10</span>
                                </li>
                                 <li class="mb-1 py-2 px-3 bg-light d-flex justify-content-between align-items-center rounded">
                                    <a class="text-dark" href="#"><i class="fa fa-angle-right text-primary mr-2"></i>Copias/Impresión</a>
                                    <span class="badge badge-primary badge-pill">8</span>
                                </li>
                                <li class="mb-1 py-2 px-3 bg-light d-flex justify-content-between align-items-center rounded">
                                    <a class="text-dark" href="#"><i class="fa fa-angle-right text-primary mr-2"></i>Bares/Snacks</a>
                                    <span class="badge badge-primary badge-pill">7</span>
                                </li>
                                <li class="py-2 px-3 bg-light d-flex justify-content-between align-items-center rounded">
                                    <a class="text-dark" href="#"><i class="fa fa-angle-right text-primary mr-2"></i>Librerías</a>
                                    <span class="badge badge-primary badge-pill">5</span>
                                </li>
                            </ul>
                        </div>
                    </div>

                    <div class="mb-5">
                        <h4 class="text-uppercase mb-4" style="letter-spacing: 5px;">Últimas Reseñas</h4>
                         <div class="bg-white shadow-sm rounded p-4">
                            <a href="#" class="d-flex align-items-center text-decoration-none mb-3">
                                <img class="img-fluid rounded" src="img/blog-1.jpg" style="width: 80px; height: 80px; object-fit: cover;" alt="">
                                <div class="pl-3">
                                    <h6 class="m-1">Review sobre Local X</h6>
                                    <small>Ene 01, 2025</small>
                                </div>
                            </a>
                             <a href="#" class="d-flex align-items-center text-decoration-none mb-3">
                                <img class="img-fluid rounded" src="img/blog-2.jpg" style="width: 80px; height: 80px; object-fit: cover;" alt="">
                                <div class="pl-3">
                                    <h6 class="m-1">Review sobre Local Y</h6>
                                    <small>Ene 01, 2025</small>
                                </div>
                            </a>
                             <a href="#" class="d-flex align-items-center text-decoration-none">
                                <img class="img-fluid rounded" src="img/blog-3.jpg" style="width: 80px; height: 80px; object-fit: cover;" alt="">
                                <div class="pl-3">
                                    <h6 class="m-1">Review sobre Local Z</h6>
                                    <small>Ene 01, 2025</small>
                                </div>
                            </a>
                        </div>
                    </div>

                    <div class="mb-5">
                        <h4 class="text-uppercase mb-4" style="letter-spacing: 5px;">Etiquetas Populares</h4>
                        <div class="d-flex flex-wrap m-n1">
                            <a href="" class="btn btn-light btn-sm m-1">Barato</a>
                            <a href="" class="btn btn-light btn-sm m-1">Rápido</a>
                            <a href="" class="btn btn-light btn-sm m-1">Buen ambiente</a>
                            <a href="" class="btn btn-light btn-sm m-1">WiFi Gratis</a>
                            <a href="" class="btn btn-light btn-sm m-1">Para grupos</a>
                            <a href="" class="btn btn-light btn-sm m-1">Tranquilo</a>
                            <a href="" class="btn btn-light btn-sm m-1">Cerca Ingahuacho</a>
                            <a href="" class="btn btn-light btn-sm m-1">Cerca Huachi</a>
                        </div>
                    </div>
                </div>
                </div>
        </div>
    </div>
    <div id="footer-placeholder">
        </div>
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.bundle.min.js"></script>
    <script src="lib/easing/easing.min.js"></script>
    <script src="lib/owlcarousel/owl.carousel.min.js"></script>
    <script src="lib/tempusdominus/js/moment.min.js"></script>
    <script src="lib/tempusdominus/js/moment-timezone.min.js"></script>
    <script src="lib/tempusdominus/js/tempusdominus-bootstrap-4.min.js"></script>

    <script src="js/main.js"></script>

    <script>
    document.addEventListener('DOMContentLoaded', function () {
        // --- Variables Globales para Reviews ---
        const reviews = JSON.parse(localStorage.getItem('reviews')) || {}; // Cargar reseñas desde localStorage
        const reviewsPerPage = 5; // Mostrar más reseñas por página
        let currentLocal = null; // Local seleccionado actualmente
        let currentPage = 1; // Página actual de reseñas

        // --- Elementos del DOM ---
        const stars = document.querySelectorAll('#starRating .fa-star');
        const ratingInput = document.getElementById('rating');
        const reviewForm = document.getElementById('reviewForm');
        const reviewFormTitle = document.getElementById('reviewFormTitle');
        const reviewsListContainer = document.getElementById('reviewsList'); // El div donde van las reseñas
        const paginationContainer = document.querySelector('#reviewsListContainer .pagination'); // Contenedor de paginación (si lo agregas)
        const reviewLinks = document.querySelectorAll('.review-link'); // Enlaces en los blog items
        const localNameInput = document.getElementById('localName'); // Input oculto en el form

        // --- Funciones ---

        // Resaltar estrellas al pasar el mouse o hacer clic
        function highlightStars(value) {
            const ratingValue = parseInt(value, 10) || 0; // Asegura que sea número
            stars.forEach(star => {
                const starValue = parseInt(star.getAttribute('data-value'), 10);
                if (starValue <= ratingValue) {
                    star.classList.add('text-warning');
                    star.classList.remove('text-muted');
                } else {
                    star.classList.add('text-muted');
                    star.classList.remove('text-warning');
                }
            });
        }

        // Renderizar estrellas estáticas para una reseña existente
        function renderStaticStars(rating) {
            const ratingValue = parseInt(rating, 10) || 0;
            let starsHtml = '';
            for (let i = 1; i <= 5; i++) {
                if (i <= ratingValue) {
                    starsHtml += '<i class="fa fa-star text-warning"></i>';
                } else {
                    starsHtml += '<i class="fa fa-star text-muted"></i>';
                }
            }
            return `<div class="mb-1">${starsHtml}</div>`; // Añadir margen inferior
        }

        // Renderizar la lista de reseñas para el local actual y página actual
        function renderReviews() {
             reviewsListContainer.innerHTML = ''; // Limpiar lista anterior
             if (!currentLocal || !reviews[currentLocal] || reviews[currentLocal].length === 0) {
                 reviewsListContainer.innerHTML = '<p class="text-center text-muted">Todavía no hay reseñas para este local. ¡Sé el primero!</p>';
                 // Ocultar paginación si no hay reseñas
                 if(paginationContainer) paginationContainer.parentElement.classList.add('d-none');
                 return;
             }

            // Ordenar reseñas (opcional, ej: más nuevas primero si tuvieras timestamp)
            const localReviews = reviews[currentLocal]; //.sort((a, b) => b.timestamp - a.timestamp); // Necesitarías guardar timestamp

            const totalPages = Math.ceil(localReviews.length / reviewsPerPage);
            const start = (currentPage - 1) * reviewsPerPage;
            const end = start + reviewsPerPage;
            const paginatedReviews = localReviews.slice(start, end);

            if (paginatedReviews.length === 0 && currentPage > 1) {
                // Si estamos en una página vacía (ej: después de borrar), ir a la anterior
                currentPage--;
                renderReviews(); // Volver a renderizar
                return;
            }

            paginatedReviews.forEach((review, index) => {
                 const reviewItem = document.createElement('div');
                 reviewItem.classList.add('review-item');
                 // Escapar HTML en reviewText para seguridad básica
                 const safeReviewText = review.reviewText.replace(/</g, "&lt;").replace(/>/g, "&gt;");
                 reviewItem.innerHTML = `
                     ${renderStaticStars(review.rating)}
                     <p class="mb-0">${safeReviewText}</p>
                     `;
                 reviewsListContainer.appendChild(reviewItem);
            });

             // Renderizar paginación (si hay más de una página)
             renderPagination(totalPages);
        }

         // Renderizar controles de paginación
        function renderPagination(totalPages) {
            if (!paginationContainer) return; // Salir si no hay contenedor de paginación

            paginationContainer.innerHTML = ''; // Limpiar paginación anterior

            if (totalPages <= 1) {
                 paginationContainer.parentElement.classList.add('d-none'); // Ocultar si solo hay 1 página
                return;
            }

            paginationContainer.parentElement.classList.remove('d-none'); // Mostrar si hay más de 1 página

            // Botón Anterior
            const prevLi = document.createElement('li');
            prevLi.classList.add('page-item', currentPage === 1 ? 'disabled' : '');
            prevLi.innerHTML = `<a class="page-link" href="#" data-page="${currentPage - 1}" aria-label="Previous"><span aria-hidden="true">&laquo;</span></a>`;
            if (currentPage > 1) {
                prevLi.querySelector('a').addEventListener('click', handlePaginationClick);
            }
            paginationContainer.appendChild(prevLi);

            // Números de Página
            for (let i = 1; i <= totalPages; i++) {
                const pageLi = document.createElement('li');
                pageLi.classList.add('page-item', i === currentPage ? 'active' : '');
                pageLi.innerHTML = `<a class="page-link" href="#" data-page="${i}">${i}</a>`;
                pageLi.querySelector('a').addEventListener('click', handlePaginationClick);
                paginationContainer.appendChild(pageLi);
            }

            // Botón Siguiente
             const nextLi = document.createElement('li');
            nextLi.classList.add('page-item', currentPage === totalPages ? 'disabled' : '');
            nextLi.innerHTML = `<a class="page-link" href="#" data-page="${currentPage + 1}" aria-label="Next"><span aria-hidden="true">&raquo;</span></a>`;
             if (currentPage < totalPages) {
                nextLi.querySelector('a').addEventListener('click', handlePaginationClick);
            }
            paginationContainer.appendChild(nextLi);
        }

        // Manejador para clics en paginación
        function handlePaginationClick(e) {
            e.preventDefault();
            const targetPage = parseInt(this.getAttribute('data-page'));
            if (targetPage && targetPage !== currentPage) {
                currentPage = targetPage;
                renderReviews();
            }
        }

        // --- Event Listeners ---

        // Clic en estrellas del formulario
        stars.forEach(star => {
            star.addEventListener('mouseover', function () {
                highlightStars(this.getAttribute('data-value'));
            });
            star.addEventListener('mouseout', function () {
                highlightStars(ratingInput.value); // Volver a la selección actual
            });
            star.addEventListener('click', function () {
                ratingInput.value = this.getAttribute('data-value');
                document.getElementById('ratingError').classList.add('d-none'); // Ocultar error al seleccionar
                highlightStars(ratingInput.value);
            });
        });

        // Clic en un enlace de blog item (imagen o título)
        reviewLinks.forEach(link => {
            link.addEventListener('click', function (e) {
                e.preventDefault();
                const selectedLocal = this.getAttribute('data-local');

                if (selectedLocal) {
                    currentLocal = selectedLocal;
                    localNameInput.value = currentLocal; // Actualizar input oculto
                    reviewFormTitle.textContent = `Tu reseña para: ${currentLocal}`; // Actualizar título del form
                    currentPage = 1; // Resetear a la primera página de reseñas
                    renderReviews(); // Mostrar reseñas del local seleccionado

                    // Scroll suave hacia el formulario y resaltarlo
                    const reviewsSection = document.getElementById('reviewsContainer');
                     if (reviewsSection) {
                        reviewsSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
                        reviewForm.classList.add('border', 'border-primary', 'shadow-lg'); // Resaltar
                        setTimeout(() => {
                             reviewForm.classList.remove('border', 'border-primary', 'shadow-lg');
                        }, 1500);
                     }
                     // Limpiar formulario anterior por si acaso
                     reviewForm.reset();
                     ratingInput.value = '';
                     highlightStars(0);
                     document.querySelectorAll('.text-danger').forEach(el => el.classList.add('d-none'));
                }
            });
        });

        // Envío del formulario de reseña
        reviewForm.addEventListener('submit', function (e) {
            e.preventDefault();

            // Ocultar mensajes de error previos
            document.querySelectorAll('#reviewForm .text-danger').forEach(el => el.classList.add('d-none'));

            let isValid = true;

            const localName = localNameInput.value.trim();
             // Validar que se haya seleccionado un local (aunque el input está oculto, currentLocal debe tener valor)
             if (!currentLocal || !localName) {
                 // Podrías mostrar un error general si intentan enviar sin seleccionar local
                 alert("Por favor, selecciona primero un local haciendo clic en su imagen o título.");
                 isValid = false;
             }

            const rating = ratingInput.value.trim();
            if (!rating) {
                document.getElementById('ratingError').classList.remove('d-none');
                isValid = false;
            }

            const reviewText = document.getElementById('reviewText').value.trim();
            if (!reviewText) {
                document.getElementById('reviewTextError').classList.remove('d-none');
                isValid = false;
            }

            if (isValid) {
                // Crear objeto de reseña (podrías añadir user, date, etc.)
                const newReview = {
                    // user: 'Usuario Anónimo', // O pedir nombre
                    rating: rating,
                    reviewText: reviewText
                    // timestamp: Date.now() // Útil para ordenar
                };

                // Añadir la reseña al array del local correspondiente
                if (!reviews[currentLocal]) {
                    reviews[currentLocal] = []; // Crear array si no existe
                }
                reviews[currentLocal].unshift(newReview); // Añadir al principio (más nuevas primero)

                // Guardar en localStorage
                try {
                    localStorage.setItem('reviews', JSON.stringify(reviews));
                } catch (error) {
                    console.error("Error saving to localStorage:", error);
                    // Podría ser que localStorage esté lleno
                    alert("No se pudo guardar la reseña. Espacio de almacenamiento lleno.");
                }


                // Volver a renderizar las reseñas (debería mostrar la nueva)
                currentPage = 1; // Ir a la primera página para ver la nueva reseña
                renderReviews();

                // Limpiar formulario
                reviewForm.reset();
                ratingInput.value = '';
                highlightStars(0); // Resetear estrellas visualmente
                 reviewFormTitle.textContent = `¡Gracias por tu reseña para ${currentLocal}!`; // Mensaje de éxito temporal
                 setTimeout(() => {
                      if (currentLocal) reviewFormTitle.textContent = `Tu reseña para: ${currentLocal}`;
                      else reviewFormTitle.textContent = `Selecciona un local para reseñar`;
                 }, 3000);


            }
        });


        // --- Carga Inicial ---
         // No renderizar reseñas al inicio, esperar a que el usuario seleccione un local.
         reviewsListContainer.innerHTML = '<p class="text-center text-muted">Haz clic en la imagen o título de un local para ver o añadir reseñas.</p>';
         if(paginationContainer) paginationContainer.parentElement.classList.add('d-none'); // Ocultar paginación inicial


         // --- Cargar Footer (código que ya tenías) ---
         fetch('footer.html')
            .then(response => {
                if (!response.ok) {
                    throw new Error('Network response was not ok ' + response.statusText);
                }
                return response.text();
            })
            .then(html => {
                // Asegúrate de que exista el placeholder antes de intentar insertarlo
                const footerPlaceholder = document.getElementById('footer-placeholder');
                if(footerPlaceholder){
                     footerPlaceholder.innerHTML = html;
                    // Si necesitas re-inicializar JS del footer
                    // if (typeof initBackToTop === 'function') { initBackToTop(); }
                } else {
                    console.error("Footer placeholder not found!");
                }

            })
            .catch(error => {
                console.error('Error loading footer:', error);
                const footerPlaceholder = document.getElementById('footer-placeholder');
                if(footerPlaceholder) {
                    footerPlaceholder.innerHTML = '<p class="text-center text-danger">Error al cargar el pie de página.</p>';
                }
            });

    }); // Fin DOMContentLoaded
    </script>


</body>

</html>